

<!doctype html>
<html lang="en">
  <head>
  	<link rel="icon" href="blank.ico">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Judicial arXiv is a semantic search engine for the judgements of the Supreme Court of Pakistan.">
	<meta name="keywords" content="Supreme Court of Pakistan">
	<meta  property="og:description" content="Judicial arXiv is a semantic search engine for the judgements of the Supreme Court of Pakistan.">
	<meta property="og:title" content="Judicial arXiv"/>
	<meta property="og:image:width" content="1200"/>
	<meta property="og:image:height" content="627"/>	
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" href="bsstylesheet.css">
	<link rel="stylesheet" type="text/css" href="http://www.visitednationalparks.com/bsstylesheet.css">
	<link rel="prefetch" href='https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/tags.json' as="document">
	
	
	
	
    <title>Judicial arXiv</title>
  </head>
  <body  class="pt-5">


		<!--Navigation bar-->
		<div id="navbar">
			<nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #00401A">

			  <div class="container">
				<a class="navbar-brand" style="color: #FFFFFF" href="http://osamakhalid.org/home.html">
					Osama Khalid
				</a>

			  </div>
			</nav>


		</div>
		<!--end of Navigation bar-->

<div class="container">
	<div class="jumbotron">
		<div class="row  justify-content-center mt-5">
			<div class="col-md-6 text-center">
				<h1 class="text-center">Judicial arXiv</h1>
			</div>
		</div>
		<div class="row  justify-content-center mt-2">
			<div class="col-md-5 text-center">
				<h5 class="text-center"><b>Judicial arXiv</b> is a semantic search engine for the judgements of the<a target="_blank" href="https://www.supremecourt.gov.pk/judgement-search/"> Supreme Court of Pakistan</a>.</h5>
				<h6 class="text-center">Currently covering: 2002-2024</h6>
				<h6 class="text-center">[For Research Purposes Only]</h6>
			</div>
		</div>
	
		<div class="row  justify-content-center mt-3">
			<div class="col-md-6 text-center">
				<p class="text-center"><b>Note:</b> For feedback please contact <a target="_blank" href="https://twitte</div>r.com/osamakhalyd">me</a></p>
			</div>
		</div>
		


		<div class="row  justify-content-center mt-5">
			<div class="col-md-4 text-center">
				<div class="input-group">
				  <input type="search" id="token" class="form-control rounded" placeholder="Search"  />
				  

				  <label for="token"  class="btn btn-outline-primary" onclick="search_word(document.getElementById('token').value)">Look Up</label>
				  
				  
				</div>
			</div>
		</div>
		<div class="row  justify-content-center mt-3">
			<div class="col-md-6 text-center">
				<p class="text-center" id="search_term"></p>
			</div>
		</div>
		<div class="row  justify-content-center mt-3">
			<div class="col-md-6 text-center">
				<p class="text-center" id="recommended_terms"></p>
			</div>
		</div>
		<div class="row  justify-content-center mt-5">
			<div class="col-md-6 text-center" id="sorting_button">
			</div>
		</div>
		
		<div class="row  justify-content-center mt-5">
			<div class="col-md-10 text-center">		
				<div id="display_table">
				</div>
			</div>
		</div>
	
<script>
window.addEventListener('load', get_tags);
globalThis.lemma_map = {}
globalThis.stemmer = {}
globalThis.similar_words = {}
globalThis.tfidf = {}
globalThis.similar_case = {}
globalThis.case_info = {}
globalThis.tags = {}
intersectSets = (a, b) => {
    const c = new Set;
    a.forEach(v => b.has(v) && c.add(v));
    return c;
};

function get_tags(){
	var url = 'https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/tags.json'
	var allText= httpGet(url);
	var allJSON=JSON.parse(allText);
	globalThis.tags = allJSON;
}
function sortObj(obj) {
    // Sort object as list based on values
    return Object.keys(obj).map(k => ([k, obj[k]])).sort((a, b) => (b[1] - a[1]))
}
function httpGet(theUrl)
    {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
    xmlHttp.send( null );
    return xmlHttp.responseText;
    }



function recommendations(recommended_words){
	const  word_similarity= {};
	
	for (i=0;i<recommended_words.length;i++){
		for (item in recommended_words[i]){
			if (!(item in word_similarity)) {
   				word_similarity[item] = recommended_words[i][item];
			}else{
				word_similarity[item] = word_similarity[item] + recommended_words[i][item];
			}
		}
	}
	var recommendations = document.getElementById("recommended_terms");
	recommendations.innerHTML = '<b>Related Terms: </b>'
	sorted = sortObj(word_similarity)
	for (i=0;i<Math.min(sorted.length, 10);i++){
		if (sorted[i][1]>0){
			var word = sorted[i][0]
			var button = document.createElement("a");
			button.setAttribute("href", "#");
			button.setAttribute("onclick", 'search_word('+"'"+word+"'"+')');    
			button.textContent = word;
			recommendations.appendChild(button)
			recommendations.appendChild(document.createTextNode(" "));	
			if ((i) % 7 == 6) {
				recommendations.appendChild(document.createElement("br"));	
			}

		}
	}
}
function search_word(elem){
    if(elem.length == 0){
		return
	}
	
	words = elem.toLowerCase().split(' ').map(word => word.trim()).filter(word => word !== '');
    words = new Set(words);
    words = Array.from(words);
	
    document.getElementById("search_term").innerHTML="Showing Results for:"+"<b> "+elem+"</b>"
    document.getElementById("token").value=elem
	
	var lemma_set = [];
	
	for (let i = 0; i < words.length; i++) {
		const word = words[i];
		const lemma = word.substring(0, 2);
		lemma_set.push(lemma);
	}
    lemma_set = new Set(lemma_set);
	lemma_set = Array.from(lemma_set);

	for (let i=0;i<lemma_set.length;i++){
		lemma = lemma_set[i]
		if (lemma in globalThis.lemma_map) {
			
		} else {
			var url='https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/lemma_map/'+lemma+'.json';
			var allText= httpGet(url);
			if (allText) {
				_json = JSON.parse(allText)
				globalThis.lemma_map[lemma] = _json;
				for (item in _json) {
    				globalThis.stemmer[item]=_json[item];
					}
				var sim_url='https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/most_similar/'+lemma+'.json';
				var simText= httpGet(sim_url);	
				json_ = JSON.parse(simText)
				globalThis.similar_words[lemma] = json_;
				}
		}
	}
	
	recommended_words = []		
	stemmed_words = []
	for (let i = 0; i < words.length; i++) {
		const word = words[i]
		if (word in globalThis.stemmer) {
			const lemma = word.substring(0, 2);
			stemmed_words.push(globalThis.stemmer[word])
			// Get recommended words for the lemma and stemmer word
			recommended_words.push(globalThis.similar_words[lemma][globalThis.stemmer[word]])
		}
	}
	
	recommendations(recommended_words)
    ranking = ranked_lookup(stemmed_words);
	console.log(ranking)
	sorting_button = document.getElementById("sorting_button")
	sorting_button.innerHTML = ''
	
	if(ranking == undefined){
		table_div = document.getElementById("display_table")
		table_div.innerHTML = ''
		return;
	}


	var relevance = document.createElement("button");
	relevance.setAttribute("id", "relevance");
	relevance.setAttribute("type", "button");
	relevance.setAttribute("class", "btn btn-primary");    
	relevance.textContent = "Relevance";
	relevance.onclick = function()
	{
		display_default(ranking, "default")
	}
	sorting_button.appendChild(relevance)

	var oldest = document.createElement("button");
	oldest.setAttribute("id", "oldest");
	oldest.setAttribute("type", "button");
	oldest.setAttribute("class", "btn btn-primary");    
	oldest.textContent = "Oldest"; 
	oldest.onclick = function()
	{
		display_default(ranking, "oldest")
	}
	sorting_button.appendChild(oldest)
	
	var newest = document.createElement("button");
	newest.setAttribute("id", "newest");
	newest.setAttribute("type", "button");
	newest.setAttribute("class", "btn btn-primary");    
	newest.textContent = "Newest"; 
	newest.onclick = function()
	{
		display_default(ranking, "newest")
	}
	sorting_button.appendChild(newest)
    display_default(ranking, "default")
}

function display_default(ranking, ordering){
	var sorting_order = {"default":0, "oldest":2, "newest":1}
	table_div = document.getElementById("display_table")
	table_div.innerHTML = ''

	var display_table = document.createElement('table');

	let table_head = ["Rank", "Case Subject","Case No.","Case Title","Author Judge","Judgement Date", "Pages", "Tags", "Similar Cases"];
	
	display_table.setAttribute("class", "table");
	let thead = display_table.createTHead();
	let row = thead.insertRow();
	for (let i = 0; i < table_head.length; i++) {
		let th = document.createElement("th");
		let text = document.createTextNode(table_head[i]);
			th.appendChild(text);
			row.appendChild(th);
	}
	console.log(display_table)
	ranking_index = sorting_order[ordering]
	console.log(ranking_index)

    for (i=0;i<Math.min(ranking[ranking_index].length, 1000);i++){
		//RANK
		let row = display_table.insertRow();
		row.setAttribute('class',"align-top")
		case_url = 'https://www.supremecourt.gov.pk/downloads_judgements/'+ranking[ranking_index][i][0]
		//console.log(case_url)
		let rank_cell = row.insertCell();
		let rank_text = document.createTextNode(i+1);
		rank_cell.appendChild(rank_text);
		//console.log(globalThis.case_info[ranking[ranking_index][i][0]])
		let case_sub_cell = row.insertCell();
		let case_sub_text = document.createTextNode(globalThis.case_info[ranking[ranking_index][i][0]]['caseSubject']);
		case_sub_cell.appendChild(case_sub_text);
		
		//CASE NO
		let case_no_cell = row.insertCell();
		
		var case_no_text = document.createElement('a');
		case_no_text.setAttribute('href', case_url);
		case_no_text.setAttribute('target', '_blank'); // Added target="_blank"
		case_no_text.textContent = globalThis.case_info[ranking[ranking_index][i][0]]['caseNumber']
		case_no_cell.appendChild(case_no_text);
		//case_no_cell.appendChild(case_no_text);

		//Case Title
		let case_title_cell = row.insertCell();
		let case_title_text = document.createTextNode(globalThis.case_info[ranking[ranking_index][i][0]]['caseTitle']);
		case_title_cell.appendChild(case_title_text);

		//case judge
		let case_judge_cell = row.insertCell();
		let case_judge_text = document.createTextNode(globalThis.case_info[ranking[ranking_index][i][0]]['authorJudge']);
		case_judge_cell.appendChild(case_judge_text);

		//case date
		let case_date_cell = row.insertCell();
		let case_date_text = document.createTextNode(globalThis.case_info[ranking[ranking_index][i][0]]['dateCreated']);
		case_date_cell.appendChild(case_date_text);

		//case pages
		case_id = ranking[ranking_index][i][0]
		pages = ranking[3][case_id]
		console.log(pages)
		url = case_url = 'https://www.supremecourt.gov.pk/downloads_judgements/'
		let page_cell = row.insertCell();
        for (k=0;k< pages.length; k++){
			let page_text = document.createElement('a');
			page_url = url+case_id+'#page='+pages[k]
			page_text.setAttribute('href', page_url); 
			page_text.setAttribute('target', '_blank'); // Added target="_blank"        
			page_text.textContent = pages[k];  
			page_cell.appendChild(page_text);
			let space = document.createTextNode(" ");
			page_cell.appendChild(space);
        }

		
		tags_set = globalThis.tags[case_id]
		console.log(case_id,tags_set)

		let tag_cell = row.insertCell();
		if (typeof tags_set !== 'undefined'){
			for (k=0;k< Math.min(tags_set.length,10); k++){

				var tag_text = document.createElement("a");
				tag_text.setAttribute("href", "#");
				tag_text.setAttribute("onclick", 'search_word('+"'"+tags_set[k]+"'"+')');    
				tag_text.textContent = tags_set[k];
			
				tag_cell.appendChild(tag_text);
				let space = document.createTextNode(" ");
				tag_cell.appendChild(space);
			}
		}
		else{
			let tag_text = document.createTextNode("No Tags");
			tag_cell.appendChild(tag_text);
			
		}
		similar_set = globalThis.similar_case[ranking[ranking_index][i][0]]
		similar_set_sort = sortObj(similar_set)
		similar_set_sort = similar_set_sort.slice(0, 5)
		
		//console.log(similar_set_sort)
		let similar_cell = row.insertCell();
		
		for (k=0;k< Math.min(similar_set_sort.length,5); k++){
			case_hist = similar_set_sort[k][0]
			console.log(case_hist)
		
		}
	

		
    }
	table_div.appendChild(display_table)
}

let pagemap={};
function ranked_lookup(words){
    //console.log(words)
	
	relevance_score = {}

	for (i in words){
		word = words[i]
		if (lemma in globalThis.tfidf) {
			
		} else {
			
			var url='https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/tfidf/'+word+'.json';
			var allText= httpGet(url);
			var allJSON=JSON.parse(allText);
			globalThis.tfidf[word] = allJSON;
			
		}
		for (var key in globalThis.tfidf[word]) {
			relevance_score[key] = 1;
		}
	}
	pageObj = {}
	for (i in words){
		word = words[i]
		cases = globalThis.tfidf[word]
		
		for (var case_key in relevance_score){
			if (!(case_key in pageObj)) {
   				pageObj[case_key] = [];
			}
			
			if (case_key in cases){
				var keys = Object.keys(globalThis.tfidf[word][case_key]);
		        for (var k in keys){
		            pageObj[case_key].push(keys[k])
		        }				
				SCORE = globalThis.tfidf[word][case_key][keys[0]]
        		SCORE = parseFloat(SCORE);
				relevance_score[case_key] = relevance_score[case_key] * SCORE
			}else{
		
				relevance_score[case_key] = relevance_score[case_key] *0
			}
		}
	}
	
	//console.log(pageObj)
	sorted_relevance = sortObj(relevance_score)
	rank_default = []
	valid_cases = []
	for (i in sorted_relevance){
		if (sorted_relevance[i][1] == 0){
		}
		else{
			case_hist = sorted_relevance[i][0]
			if (case_hist in globalThis.case_info) {
			
			} else {
			
				var url='https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/similarity_scores/'+case_hist+'.json';
				var allText= httpGet(url);
				var allJSON=JSON.parse(allText);
				globalThis.similar_case[case_hist] = allJSON;

				var url='https://raw.githubusercontent.com/osama-website/_judicialarxiv/master/cases/'+case_hist+'.json';
				var allText= httpGet(url);
				var allJSON=JSON.parse(allText);
				globalThis.case_info[case_hist] = allJSON;

				
			
			}	
			
			rank_default.push(sorted_relevance[i])
			valid_cases.push(sorted_relevance[i][0])
		}
	}
	//console.log(valid_cases)
	rel_page = {}
	
	for (page in pageObj){
		
		if (valid_cases.includes(page)){
			//console.log(page)
			page_set = pageObj[page]
			page_set = new Set(page_set);
			page_set = Array.from(page_set);

			rel_page[page] = page_set
		}
	}
	//rank_default
	//rel_page
	dates = {}
	for (i in rank_default){
		 dateObj = globalThis.case_info[rank_default[i][0]]['dateCreated']
		const dateParts = dateObj.split('-');
		const day = parseInt(dateParts[0]);
		const month = parseInt(dateParts[1]) - 1; // months are zero-based
		const year = parseInt(dateParts[2]);
		const datetimeObj = new Date(year, month, day);
				
		 dates[rank_default[i][0]] = datetimeObj
	}
	//console.log(rel_page)
	rank_oldest = []

	rank_new = sortObj(dates)
		
	for (let i = rank_new.length - 1; i >= 0; i--) {
		const item = rank_new[i];
			rank_oldest.push(item)
	}
	//console.log(rank_oldest)
	//console.log(rank_default)
	//console.log(rank_new)
	return([rank_default,rank_new,rank_oldest,rel_page])
	
    
}

function stemmer(words) {
    word_keys = []
    // Get first letters of words
    for (i in words){
        key = words[i][0];
        //console.log(key)
        if (typeof key !== 'undefined') {
            if(key.charCodeAt(0) >= 'a'.charCodeAt(0) && key.charCodeAt(0) <= 'z'.charCodeAt(0)) {
                word_keys.push(key);    
            }
        }
    }
    //console.log(word_keys)
    //Get Unique Words
    var word_keys_set = new Set(word_keys);
    word_keys_set = Array.from(word_keys_set);
    // get URLS
    word_set = []
    var word_dict = {}
    for (i in word_keys_set){
        key = word_keys_set[i]
        var url='https://raw.githubusercontent.com/osama-website/_NA_words/main/'+key+'.json';
        var allText= httpGet(url);
        var allJSON=JSON.parse(allText);
        for (item in allJSON){
            if (words.includes(item)){ 
                word_set.push(allJSON[item]);
            }
        }
    }
    //console.log(words)
    //console.log(word_set)
    return(word_set)
};

</script>

    
  </body>
</html>

